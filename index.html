<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="moment.min.js"></script>
    <link rel="stylesheet" type="text/css" href="index.css">
    <link href='http://fonts.googleapis.com/css?family=Delius+Swash+Caps|Old+Standard+TT:400,400italic' rel='stylesheet' type='text/css'>
  </head>
  <body>

    <script>
      $(document).ready(function(){


        var $body = $('body');
        $body.html('');

        var $header = $('<header><h1>Welcome to Twittler!</h1><h5>where your friends twittle their thumbs out loud</h5></header>');
        $body.append($header);

        var $content = $('<div class="content"/>');
        $body.append($content);

        var $loadButton = $('<button type="button" id="loadButton">Load more twittles!</button>');
        $content.append($loadButton);

        var $tweetList = $('<div id="tweetList"/>');


        function loadTweets(user) {
          /* allow the user to click on a username to see that user's timeline */
          /* allow the user to create tweets (shouldn't need to modify main js file) */
          $tweetList.html('');

          var stream;

          if (user && streams.users[user]) {
            stream = streams.users[user];
          } else {
            stream = streams.home;
          }

          var index = stream.length - 1;
          while(index >= 0){
            var tweet = stream[index];

            var user = tweet.user;
            var time = moment(tweet.created_at).fromNow();
            var message = tweet.message;

            var $tweet = $('<div class="tweet"><span class="user">@' + user + '</span> <span class="time">(' + time + ')</span>: <span class="message">' + message + '</span></div>');

            $tweetList.append($tweet);
            index -= 1;
          }

          $('.user').on('click', function(){
            var user = $(this).text().replace('@','');
            loadTweets(user);
          });

        }


        $content.append($tweetList);

        $('#loadButton').on('click', function(){
          loadTweets();
        });

        loadTweets();



      });

    </script>
  </body>
</html>
